#!/bin/bash

monthend=12
monthstart=01
year=2013
year=2016
tableName=aggregateToDays

declare -a arr="
41001
41002
41003
41004
41005
41006
41040
41008
41009
41010
41044
41012
41013
41048
41016
41017
41018
41021
41022
41056
41024
41025
41027
41029
41030
41033
41035
41036
41037
41038
41040
41041
41043
41044
41046
41047
41048
41049
41051
41052
41053
41056
41090
41060
41061
41095
41096
41064
41108
41109
41110
41112
41113
41114
41115
41140
41141
41159
41193
41194
41NT1
41NT2
42001
42002
42003
42004
42005
42006
42007
42008
42009
42010
42011
42012
42013
42014
42015
42016
42050
42051
42019
42020
42021
42022
42023
42025
42035
42036
42037
42038
42039
42040
42041
42075
42043
42044
42045
42046
42047
42086
42054
42055
42056
42057
42058
42059
42060
42065
42067
42080
42085
42120
42121
42089
42123
42130
42098
42099
42360
42361
42362
42363
42364
42365
42369
42370
42374
42375
42376
42390
42392
42394
42395
42887
42935
42A02
42A03
42OTP
43043
44001
44004
44005
44006
44007
44008
44009
44010
44011
44012
44013
44014
44015
44017
44018
44019
44020
44021
44022
44056
44024
44025
44059
44027
44028
44029
44030
44031
44032
44033
44034
44035
44037
44038
44039
44040
44041
44042
44043
44077
44052
44053
44054
44055
44056
44057
44058
44059
44060
44061
44062
44063
44064
44065
44066
44067
44068
44102
44070
44105
44122
44123
44091
44125
44093
44094
44095
44096
44097
44098
44099
44100
44172
44268
  "

psql -h localhost -p 5439 -U buoydbuser -d buoydb -c "
CREATE TABLE $tableName(
  buoyid VARCHAR(5),
  yy float,
  mm float,
  dd float,
  wdir float,
  wspd float,
  gst float,
  wvht float,
  dpd float,
  apd float,
  mwd float,
  pres float,
  atmp float,
  wtmp float,
  dewp float,
  vis float,
  tide float);"

for buoy in $arr; do
    for month in $(seq $monthstart $monthend); do
      psql -h localhost -p 5439 -U buoydbuser -d buoydb -c "INSERT INTO $tableName SELECT DISTINCT buoyid, yy, mm, dd, AVG(wdir), AVG(wspd), AVG(gst), AVG(wvht), AVG(dpd), AVG(apd), AVG(mwd), AVG(pres), AVG(atmp), AVG(wtmp), AVG(dewp), AVG(vis), AVG(tide) FROM buoydata WHERE buoyid = '$buoy' AND yy = '2016' AND mm = '$month' GROUP BY buoyid, dd, yy, mm;"
    done
done
